#!/bin/sh
# SPDX-License-Identifier: GPL-2.0
# Copyright (C) 2025-present ROCKNIX (https://github.com/ROCKNIX)
mkdir -p /run/udev/rules.d/
cat <<EOF >/run/udev/rules.d/99-touchscreen-calibration.rules
# left panel (ID_PATH=platform-a90000.i2c) -> (0 .. 1920) x (0 .. 1080)
SUBSYSTEM=="input", KERNEL=="event*", ENV{ID_INPUT_TOUCHSCREEN}=="1", \
  ENV{ID_PATH}=="platform-a90000.i2c", \
  ENV{LIBINPUT_CALIBRATION_MATRIX}="0.607595 0 0 0 1 0"

# right panel (ID_PATH=platform-98c000.i2c) -> (1920 .. 3160) x (0 .. 1080)
SUBSYSTEM=="input", KERNEL=="event*", ENV{ID_INPUT_TOUCHSCREEN}=="1", \
  ENV{ID_PATH}=="platform-98c000.i2c", \
  ENV{LIBINPUT_CALIBRATION_MATRIX}="0.392405 0 0.607595 0 1 0"
EOF
udevadm control --reload
udevadm trigger -s input